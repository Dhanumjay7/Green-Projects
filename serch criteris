/** @NApiVersion 2.1 */
const invoiceSearchObj = search.create({
   type: "invoice",
   settings:[{"name":"consolidationtype","value":"ACCTTYPE"},{"name":"includeperiodendtransactions","value":"F"}],
   filters:
   [
      ["type","anyof","CustInvc"], 
      "AND", 
      ["subsidiary","anyof","268"], 
      "AND", 
      ["taxline","is","F"], 
      "AND", 
      ["item","noneof","@NONE@"], 
      "AND", 
      ["shipping","is","F"]
   ],
   columns:
   [
      search.createColumn({
         name: "internalid",
         summary: "GROUP",
         label: "Internal ID"
      }),
      search.createColumn({
         name: "tranid",
         summary: "GROUP",
         label: "Document Number"
      }),
      search.createColumn({
         name: "custbody_agresso_invoice_number",
         summary: "GROUP",
         label: "Agresso Invoice Number"
      }),
      search.createColumn({
         name: "custbody_gds_invoice_id",
         summary: "GROUP",
         label: "GDS Invoice ID"
      }),
      search.createColumn({
         name: "entity",
         summary: "GROUP",
         label: "Name"
      }),
      search.createColumn({
         name: "custcol_invoice_detail_id",
         summary: "GROUP",
         label: "Invoice Detail ID"
      }),
      search.createColumn({
         name: "custcol_tran_type",
         summary: "GROUP",
         label: "Transaction Type"
      }),
      search.createColumn({
         name: "line",
         summary: "COUNT",
         label: "Line ID"
      })
   ]
});
const searchResultCount = invoiceSearchObj.runPaged().count;
log.debug("invoiceSearchObj result count",searchResultCount);
invoiceSearchObj.run().each(function(result){
   // .run().each has a limit of 4,000 results
   return true;
});

/*
invoiceSearchObj.id="customsearch1770029147263";
invoiceSearchObj.title="GT UK Invoices with Duplicate Line and Blank DetailId (copy)";
const newSearchId = invoiceSearchObj.save();
*/
