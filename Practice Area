function summarize(summary) {

    var rows = [];

    summary.output.iterator().each(function (_, value) {
        rows = rows.concat(value.split(','));
        return true;
    });

    if (!rows.length) return;

    var csv = "Record Type,Record ID,Document Number,Vendor ID,Message\n";

    rows.forEach(function (r) {
        var v = r.split(':');
        csv += v[0] + ',' + v[1] + ',' + v[2] + ',' + v[3] + ',' + v[4] + '\n';
    });

    var fileObj = file.create({
        name: 'ACS_Driver_Tieout_' + Date.now() + '.csv',
        fileType: file.Type.CSV,
        contents: csv,
        folder: PARAMS.FOLDER
    });

    var fileId = fileObj.save();

    var configRec = config.load({ type: config.Type.COMPANY_PREFERENCES });

    email.send({
        author: configRec.getValue('custscript_error_email_author'),
        recipients: runtime.getCurrentUser().email,
        subject: 'ACS Tieout Completed',
        body: 'ACS Tieout has been completed and the result file is attached.',
        attachments: [file.load({ id: fileId })]
    });
}
